(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d0c09a8"],{"663e":function(e,t,r){"use strict";r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return l}));var i=r("b775");function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/workOrder/startWorkOrder",method:"post",loading:t,data:e})}function o(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/workOrder/queryWorkOrder",method:"post",loading:t,data:e})}function s(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/workOrder/queryWorkOrderToMe",method:"post",loading:t,data:e})}function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/workOrder/queryWorkOrderDetail",method:"post",loading:t,data:e})}function l(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/workOrder/approveWorkOrder",method:"post",loading:t,data:e})}},ba83:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contianer"},[r("div",[e._m(0),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("p",{staticClass:"detail-lable"},[e._v("工单编号："),r("span",{staticClass:"detail-content"},[e._v(e._s(e.workOrderDetail.workOrderCode))])])])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("p",{staticClass:"detail-lable"},[e._v("工单标题："),r("span",{staticClass:"detail-content"},[e._v(e._s(e.workOrderDetail.workOrderName))])])])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("p",{staticClass:"detail-lable"},[e._v("创建人："),r("span",{staticClass:"detail-content"},[e._v(e._s(e.workOrderDetail.userName))])])])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("p",{staticClass:"detail-lable"},[e._v("创建时间："),r("span",{staticClass:"detail-content"},[e._v(e._s(e.workOrderDetail.operateTime&&new Date(e.workOrderDetail.operateTime).format("yyyy-MM-dd:hh:mm:ss")))])])])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("p",{staticClass:"detail-lable"},[e._v("状态："),r("span",{staticClass:"detail-content"},[e._v(e._s(e.workOrderDetail.workOrderStatusDesc))])])])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("p",{staticClass:"detail-lable"},[e._v("描述："+e._s(e.workOrderDetail.workOrderDesc))])])])],1)],1),e._v(" "),r("el-divider"),e._v(" "),r("div",{staticClass:"detail-title"},[r("p",[e._v("文件列表：")]),e._v(" "),r("el-row",e._l(e.workOrderDetail.workInfo,(function(t,i){return r("div",[r("el-link",{key:i,attrs:{underline:!1}},[r("span",["xls,xlsx,csv".indexOf(t.docType)>-1?r("svg-icon",{attrs:{"icon-class":"excel"}}):"ppt,pptx,pps,ppsx,pot".indexOf(t.docType)>-1?r("svg-icon",{attrs:{"icon-class":"PPT"}}):"pdf,dpt,odf".indexOf(t.docType)>-1?r("svg-icon",{attrs:{"icon-class":"PDF"}}):"doc,docx".indexOf(t.docType)>-1?r("svg-icon",{attrs:{"icon-class":"WORD"}}):"bmp,jpg,png,tif,gif,pcx,tga,exif,fpx,svg,psd,cdr,pcd,dxf,ufo,eps,ai,raw,WMF,webp,jpeg".indexOf(t.docType)>-1?r("svg-icon",{attrs:{"icon-class":"image"}}):r("svg-icon",{attrs:{"icon-class":"wendang"}}),e._v("\n          "+e._s(t.docName)+"\n        ")],1),e._v(" "),r("span",[r("a",{attrs:{href:t.docUrl,target:"_blank"}},[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("下载")])],1),e._v(" "),r("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(r){return e.handlePreview(t.docUrl)}}},[e._v("预览")])],1)])],1)})),0)],1),e._v(" "),r("el-divider"),e._v(" "),r("div",[e._m(1),e._v(" "),r("el-timeline",e._l(e.activities,(function(t,i){return r("el-timeline-item",{key:i,attrs:{color:e.workOrderDetail.workNode.nodeId>=t.nodeId?"90"==t.nodeOperateResult?"#67C23A":70==t.nodeOperateResult?"#F56C6C":"#3498db":"",size:"large",timestamp:new Date(t.nodeOperateTime).format("yyyy-MM-dd:hh:mm:ss"),placement:"top"}},[r("p",[e._v("审批人："+e._s(t.userName))]),e._v(" "),r("p",{staticClass:"approve-suggest"},[e._v("审批意见："+e._s(t.nodeOperateDesc))]),e._v(" "),r("p",[e._v("审批批注：\n            "),10==t.nodeOperateResult?r("el-link",{attrs:{type:"primary",underline:!1}},[e._v("审批中")]):e._e(),e._v(" "),90==t.nodeOperateResult?r("el-link",{attrs:{type:"success",underline:!1}},[e._v("审批通过")]):e._e(),e._v(" "),70==t.nodeOperateResult?r("el-link",{attrs:{type:"danger",underline:!1}},[e._v("审批驳回")]):e._e()],1)])})),1)],1),e._v(" "),r("div",{staticClass:"bottom-btn"},[e.type?r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handle("90")}}},[e._v("审批通过")]):e._e(),e._v(" "),e.type?r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handle("70")}}},[e._v("审批拒绝")]):e._e(),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.goback()}}},[e._v("返回")])],1),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible,title:"审批处理"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{staticClass:"demo-form-inline"},[r("el-form-item",{attrs:{label:"审批批注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.approve.remark,callback:function(t){e.$set(e.approve,"remark",t)},expression:"approve.remark"}})],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.onSubmit(e.operateStatus)}}},[e._v("提交")])],1)],1),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisibleSelectDept,title:"选择文档分配部门"},on:{"update:visible":function(t){e.dialogVisibleSelectDept=t}}},[r("el-form",{ref:"dept",attrs:{model:e.dept,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"部门",prop:"deptId"}},[r("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.dept.deptId,callback:function(t){e.$set(e.dept,"deptId",t)},expression:"dept.deptId"}},e._l(e.deptList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})),1)],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmitFinsh()}}},[e._v("提交")])],1)],1)],1)},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{staticClass:"detail-title"},[r("span",[e._v("工单信息")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{staticClass:"detail-title"},[r("span",[e._v("审批记录：")])])}],o=r("663e"),s=r("fe05"),n={name:"work-foc-detail",data:function(){return{workOrderId:"",type:!1,activities:[],workOrderDetail:{},dialogVisible:!1,dialogVisibleSelectDept:!1,operateStatus:"",approve:{},deptList:[],dept:{deptId:""},rules:{deptId:[{required:!0,message:"请选择部门",trigger:"change"}]}}},created:function(){this.workOrderId=this.$route.query.workOrderId,this.type=this.$route.query.type},mounted:function(){this.queryWorkDetail()},methods:{queryWorkDetail:function(){var e=this;Object(o["c"])({workOrderId:this.workOrderId}).then((function(t){e.$loading().close(),t.success&&(e.workOrderDetail=t.result,e.activities=JSON.parse(t.result.workNodeList),e.workOrderDetail.workInfo=JSON.parse(t.result.workInfo))}))},handlePreview:function(e){var t=decodeURI(e).lastIndexOf("."),r=decodeURI(e).substring(t+1),i="pdf swf html ott fodt  sxw doc docx rtf  wpd  txt  ods  ots  fods sxc  xls xlsx  csv  tsv  odp  otp fodp  sxi  ppt pptx  odg  otg fodg  svg  png jpg  tif  gif bmp";if(-1!=i.indexOf(r)){var a=decodeURI(e).substring(e.lastIndexOf("/")+1);-1=="xls xlsx".indexOf("this.filetype")&&window.open("".concat(window.location.protocol+"//"+window.location.host,"/electronic/pdf/documentConverterToPdf/").concat(a));var o=this.$router.resolve({path:"/pdfPreview",query:{filename:a,filetype:r}}),s=o.href;window.open(s,"_blank")}else this.$message({showClose:!0,message:"该文件不支持预览，请下载后查看",type:"warning"})},goback:function(e){this.$router.go(-1)},handle:function(e){this.dialogVisible=!0,this.operateStatus=e},onSubmit:function(e){this.workOrderDetail.nodeCount==this.workOrderDetail.workNode.nodeOrder&&"90"==e?(this.dialogVisibleSelectDept=!0,this.queryDeptList()):this.approveSubmit(e)},queryDeptList:function(){var e=this;Object(s["c"])({pageNum:1,pageSize:1e3}).then((function(t){e.$loading().close(),t.success&&(e.deptList=t.result.result)}))},onSubmitFinsh:function(){this.approveSubmit("90")},approveSubmit:function(e){var t=this;Object(o["a"])({workOrderId:this.workOrderDetail.workOrderId,currentNode:this.workOrderDetail.currentNode,workNode:{nodeId:this.workOrderDetail.workNode.nodeId,nodeOperateResult:e,nodeOperateDesc:this.approve.remark},sysDept:{deptId:this.dept.deptId}}).then((function(e){t.$loading().close(),e.success?(t.$message({type:"success",message:"操作成功"}),t.dialogVisibleSelectDept=!1,t.dialogVisible=!1,t.$router.go(-1)):t.$message({type:"fail",message:"操作失败"})}))}}},l=n,d=(r("fe2d"),r("e90a")),c=Object(d["a"])(l,i,a,!1,null,"57c04209",null);t["default"]=c.exports},c7ae:function(e,t,r){},fe05:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return n}));var i=r("b775");function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/dept/queryDept",method:"post",loading:t,data:e})}function o(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/dept/updateDept",method:"post",loading:t,data:e})}function s(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/dept/addDept",method:"post",loading:t,data:e})}function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(i["a"])({url:"/electronic/deptElectronicDoc/queryDeptElectronicDoc",method:"post",loading:t,data:e})}},fe2d:function(e,t,r){"use strict";var i=r("c7ae"),a=r.n(i);a.a}}]);