(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78cc76e6"],{4379:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"填写信息",name:"first"}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.doc,rules:e.rules,"label-width":"110px"}},[r("el-form-item",{attrs:{label:"标题",prop:"docName"}},[r("el-input",{model:{value:e.doc.docName,callback:function(t){e.$set(e.doc,"docName",t)},expression:"doc.docName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.doc.remark,callback:function(t){e.$set(e.doc,"remark",t)},expression:"doc.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"审批人选择"}},[r("el-select",{attrs:{placeholder:"请选择审批人"},on:{change:function(t){return e.selectApprove()}},model:{value:e.doc.approve,callback:function(t){e.$set(e.doc,"approve",t)},expression:"doc.approve"}},e._l(e.options,(function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"已选择审批人",prop:"approveList"}},e._l(e.doc.approveList,(function(t){return r("el-tag",{key:t.userName,staticStyle:{"margin-right":"10px"},attrs:{closable:""},on:{close:function(r){return e.handleClose(t)}}},[e._v(e._s(t.userName))])})),1),e._v(" "),r("el-form-item",[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:e.action,"file-list":e.fileList,multiple:""}},[r("i",{staticClass:"el-icon-upload"}),e._v(" "),r("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),r("em",[e._v("点击上传")])]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上传文件不超过100MB")])])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交审批")])],1)],1)],1)],1)],1)},i=[],a=(r("9a33"),r("6d57"),r("663e")),n=r("c24f"),s={name:"uploadDoc",data:function(){return{activeName:"first",dialogVisible:!1,formInline:{user:"",region:""},doc:{docName:"",remark:"",approve:"",approveList:[]},rules:{docName:[{required:!0,message:"请输入文件名称",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}],remark:[{required:!0,message:"请填写文件描述",trigger:"blur"}],approveList:[{required:!0,message:"请选择审批人",trigger:"change"}]},fileList:[],options:[],value:[],action:"",pageNum:1,pageSize:1e3,tags:[]}},mounted:function(){this.action=window.location.protocol+"//"+window.location.host+"/electronic/file/uploadFile",this.queryUserList()},methods:{handleClick:function(){},submitUpload:function(){this.$refs.upload.submit()},selectApprove:function(){var e=this,t=!1;this.doc.approveList.forEach((function(r){r==e.doc.approve&&(t=!0)})),t||this.doc.approveList.push(this.doc.approve),this.doc.approve=""},handleClose:function(e){this.doc.approveList.splice(this.doc.approveList.indexOf(e),1)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.open()}))},submitDoc:function(){var e=this,t=[],r=[],o=this.$refs.upload.uploadFiles;if(0!=o.length){for(var i=0;i<o.length;i++)t.push({docName:o[i].response.result.fileName.split("&&")[1],docUrl:decodeURI(o[i].response.result.fileDownloadUri),docType:o[i].response.result.fileType,docRandomName:o[i].response.result.fileName});for(var n=0;n<this.doc.approveList.length;n++)r.push({userId:this.doc.approveList[n].userId,nodeOrder:n+1});Object(a["e"])({workOrderName:this.doc.docName,workOrderDesc:this.doc.remark,workInfo:JSON.stringify(t),workType:"doc",workNodeList:JSON.stringify(r)}).then((function(t){e.$loading().close(),t.success?(e.$message({type:"success",message:"操作成功"}),e.$router.push({path:"/workorder/workdoc"})):e.$message({type:"erro",message:"提交失败"})}))}else this.$message({message:"请上传文件",type:"warning"})},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.submit()}))},queryUserList:function(e){var t=this;Object(n["f"])({pageSize:this.pageSize,pageNum:this.pageNum,userName:e}).then((function(e){t.$loading().close(),e.success&&(t.options=e.result.result)}))},open:function(){var e=this;this.$confirm("确定提交审批?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.submitDoc()}))}}},l=s,c=(r("54de"),r("e90a")),u=Object(c["a"])(l,o,i,!1,null,"cc4c353e",null);t["default"]=u.exports},"54de":function(e,t,r){"use strict";var o=r("85ca"),i=r.n(o);i.a},"663e":function(e,t,r){"use strict";r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return l}));var o=r("b775");function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/startWorkOrder",method:"post",loading:t,data:e})}function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrder",method:"post",loading:t,data:e})}function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrderToMe",method:"post",loading:t,data:e})}function s(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrderDetail",method:"post",loading:t,data:e})}function l(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/approveWorkOrder",method:"post",loading:t,data:e})}},"85ca":function(e,t,r){},"9a33":function(e,t,r){"use strict";var o=r("2fd4"),i=r("69b3"),a=r("f63e"),n=r("e754"),s=r("eafa"),l=r("7108"),c=r("8714"),u=r("238a"),d=Math.min,p=[].push,m="split",f="length",v="lastIndex",h=4294967295,g=!u((function(){RegExp(h,"y")}));r("0aed")("split",2,(function(e,t,r,u){var b;return b="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[f]||2!="ab"[m](/(?:ab)*/)[f]||4!="."[m](/(.?)(.?)/)[f]||"."[m](/()()/)[f]>1||""[m](/.?/)[f]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!o(e))return r.call(i,e,t);var a,n,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=void 0===t?h:t>>>0,g=new RegExp(e.source,u+"g");while(a=c.call(g,i)){if(n=g[v],n>d&&(l.push(i.slice(d,a.index)),a[f]>1&&a.index<i[f]&&p.apply(l,a.slice(1)),s=a[0][f],d=n,l[f]>=m))break;g[v]===a.index&&g[v]++}return d===i[f]?!s&&g.test("")||l.push(""):l.push(i.slice(d)),l[f]>m?l.slice(0,m):l}:"0"[m](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,o){var i=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,i,o):b.call(String(i),r,o)},function(e,t){var o=u(b,e,this,t,b!==r);if(o.done)return o.value;var c=i(e),p=String(this),m=a(c,RegExp),f=c.unicode,v=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(g?"y":"g"),k=new m(g?c:"^(?:"+c.source+")",v),w=void 0===t?h:t>>>0;if(0===w)return[];if(0===p.length)return null===l(k,p)?[p]:[];var y=0,N=0,O=[];while(N<p.length){k.lastIndex=g?N:0;var x,_=l(k,g?p:p.slice(N));if(null===_||(x=d(s(k.lastIndex+(g?0:N)),p.length))===y)N=n(p,N,f);else{if(O.push(p.slice(y,N)),O.length===w)return O;for(var L=1;L<=_.length-1;L++)if(O.push(_[L]),O.length===w)return O;N=y=x}}return O.push(p.slice(y)),O}]}))}}]);