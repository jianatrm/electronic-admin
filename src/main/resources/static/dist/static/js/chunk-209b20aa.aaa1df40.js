(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-209b20aa"],{3085:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contianer"},[r("div",[e._m(0),e._v(" "),r("el-timeline",e._l(e.activities,(function(t,o){return r("el-timeline-item",{key:o,attrs:{color:e.workOrderDetail.workNode.nodeId>=t.nodeId?"90"==t.nodeOperateResult?"#67C23A":70==t.nodeOperateResult?"#F56C6C":"#3498db":"",size:"large",timestamp:new Date(t.nodeOperateTime).format("yyyy-MM-dd:hh:mm:ss"),placement:"top"}},[r("p",[e._v("审批人："+e._s(t.userName))]),e._v(" "),r("p",{staticClass:"approve-suggest"},[e._v("审批意见："+e._s(t.nodeOperateDesc))]),e._v(" "),r("p",[e._v("审批批注：\n          "),10==t.nodeOperateResult?r("el-link",{attrs:{type:"primary",underline:!1}},[e._v("审批中")]):e._e(),e._v(" "),90==t.nodeOperateResult?r("el-link",{attrs:{type:"success",underline:!1}},[e._v("审批通过")]):e._e(),e._v(" "),70==t.nodeOperateResult?r("el-link",{attrs:{type:"danger",underline:!1}},[e._v("审批驳回")]):e._e()],1)])})),1)],1),e._v(" "),r("div",{staticClass:"bottom-btn"},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.goback()}}},[e._v("返回")])],1)])},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{staticClass:"detail-title"},[r("span",[e._v("审批记录：")])])}],i=r("663e"),d=r("fe05"),a={name:"work-node-detail",data:function(){return{workOrderId:"",type:!1,activities:[],workOrderDetail:{},dialogVisible:!1,dialogVisibleSelectDept:!1,operateStatus:"",approve:{},deptList:[],dept:{deptId:""},rules:{deptId:[{required:!0,message:"请选择部门",trigger:"change"}]}}},created:function(){this.workOrderId=this.$route.query.workOrderId},mounted:function(){this.queryWorkDetail()},methods:{queryWorkDetail:function(){var e=this;Object(i["c"])({workOrderId:this.workOrderId}).then((function(t){e.$loading().close(),t.success&&(e.workOrderDetail=t.result,e.activities=JSON.parse(t.result.workNodeList),e.workOrderDetail.workInfo=JSON.parse(t.result.workInfo))}))},handlePreview:function(e){var t=decodeURI(e).lastIndexOf("."),r=decodeURI(e).substring(t+1),o="pdf swf html ott fodt  sxw doc docx rtf  wpd  txt  ods  ots  fods sxc  xls xlsx  csv  tsv  odp  otp fodp  sxi  ppt pptx  odg  otg fodg  svg  png jpg  tif  gif bmp";if(-1!=o.indexOf(r)){var n=decodeURI(e).substring(e.lastIndexOf("/")+1);-1=="xls xlsx".indexOf("this.filetype")&&window.open("http://localhost:8001/electronic/pdf/documentConverterToPdf/".concat(n));var i=this.$router.resolve({path:"/pdfPreview",query:{filename:n,filetype:r}}),d=i.href;window.open(d,"_blank")}else this.$message({showClose:!0,message:"该文件不支持预览，请下载后查看",type:"warning"})},goback:function(e){this.$router.go(-1)},handle:function(e){this.dialogVisible=!0,this.operateStatus=e},onSubmit:function(e){this.workOrderDetail.nodeCount==this.workOrderDetail.workNode.nodeOrder&&"90"==e?(this.dialogVisibleSelectDept=!0,this.queryDeptList()):this.approveSubmit(e)},queryDeptList:function(){var e=this;Object(d["c"])({pageNum:1,pageSize:1e3}).then((function(t){e.$loading().close(),t.success&&(e.deptList=t.result.result)}))},onSubmitFinsh:function(){this.approveSubmit("90")},approveSubmit:function(e){var t=this;Object(i["a"])({workOrderId:this.workOrderDetail.workOrderId,currentNode:this.workOrderDetail.currentNode,workNode:{nodeId:this.workOrderDetail.workNode.nodeId,nodeOperateResult:e,nodeOperateDesc:this.approve.remark},sysDept:{deptId:this.dept.deptId}}).then((function(e){t.$loading().close(),e.success?(t.$message({type:"success",message:"操作成功"}),t.dialogVisibleSelectDept=!1,t.dialogVisible=!1,t.$router.go(-1)):t.$message({type:"fail",message:"操作失败"})}))}}},s=a,c=(r("c4ed"),r("e90a")),l=Object(c["a"])(s,o,n,!1,null,"88c01618",null);t["default"]=l.exports},"663e":function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return d})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s}));var o=r("b775");function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/startWorkOrder",method:"post",loading:t,data:e})}function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrder",method:"post",loading:t,data:e})}function d(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrderToMe",method:"post",loading:t,data:e})}function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/queryWorkOrderDetail",method:"post",loading:t,data:e})}function s(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/workOrder/approveWorkOrder",method:"post",loading:t,data:e})}},7275:function(e,t,r){},c4ed:function(e,t,r){"use strict";var o=r("7275"),n=r.n(o);n.a},fe05:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return a}));var o=r("b775");function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/dept/queryDept",method:"post",loading:t,data:e})}function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/dept/updateDept",method:"post",loading:t,data:e})}function d(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/dept/addDept",method:"post",loading:t,data:e})}function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o["a"])({url:"/electronic/deptElectronicDoc/queryDeptElectronicDoc",method:"post",loading:t,data:e})}}}]);